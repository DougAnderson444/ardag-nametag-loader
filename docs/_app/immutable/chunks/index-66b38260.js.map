{"version":3,"mappings":"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","names":["ctx","insert_hydration","target","append_hydration","div2","div1","offsetWidth","sendWidth","channel","handleLoad","$$invalidate","e","iframe","$$value","sandbox","CHANGE","srcdoc","srcdoc64","setProps","createEventDispatcher","props","dispatch","esModule","component","mounted","onMount","url","doFetch","fetched","text","error","loadEsModuleComponent","css","blob","App","inits","initProps","k","allProps","event","onDestroy"],"sources":["../../../../../../node_modules/@douganderson444/svelte-component-gateway/IFrame.svelte","../../../../../../node_modules/@douganderson444/svelte-component-gateway/iframeSrc/constants.js","../../../../../../node_modules/@douganderson444/svelte-component-gateway/Gateway.svelte","../../../../../../node_modules/@douganderson444/svelte-component-gateway/FetchComponent.svelte","../../../../../../node_modules/@douganderson444/svelte-component-gateway/ComponentMounter.svelte"],"sourcesContent":["<script>\r\n\t// https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/sandbox\r\n\texport let iframe = null;\r\n\texport let srcdoc;\r\n\texport let rendered;\r\n\r\n\tlet offsetWidth;\r\n\tlet sendWidth;\r\n\tlet channel;\r\n\r\n\t// unsafe hack: https://bugzilla.mozilla.org/show_bug.cgi?id=1389198\r\n\t// let sandbox = 'allow-scripts allow-same-origin'; // danger zone, but needed for camera/mic access\r\n\tlet sandbox = 'allow-scripts';\r\n\r\n\t// synchronize the width of the parent container and the iframe child\r\n\t$: iframe && iframe.addEventListener('load', handleLoad);\r\n\r\n\t// Wait for the iframe to load, then configure \"width sender\"\r\n\tasync function handleLoad() {\r\n\t\tif (!iframe || !offsetWidth) throw new Error('Missing offsetWidth');\r\n\r\n\t\tchannel = new MessageChannel();\r\n\r\n\t\tchannel.port1.onmessage = (e) => {\r\n\t\t\t// console.log('WIDTH MESSAGE', { e: e.data });\r\n\t\t\t// e.data; // do something with the reply?\r\n\t\t};\r\n\t\tsendWidth = () => {\r\n\t\t\tiframe.contentWindow.postMessage(\r\n\t\t\t\t{ offsetWidth }, // push the details to loadEsModuleComponent({ esModule, props }) in the iframe\r\n\t\t\t\t'*', // there's only 1 contentWindow on the iframe so it' safe to use '*' as origin\r\n\t\t\t\t[channel.port2]\r\n\t\t\t); // enables the iframe to send messages containing prop updates back to the parent\r\n\t\t};\r\n\t}\r\n\r\n\t$: if (offsetWidth && sendWidth) sendWidth();\r\n\r\n\t$: if (iframe && channel) {\r\n\t\t/**\r\n\t\t * Normally you wouldn't set both allow-scripts and allow-same-origin\r\n\t\t * Because the iframe can remove sandbox attribute and reload the iframe\r\n\t\t * However with svelte we can detect reload of iframe here, and add it back always\r\n\t\t * So this risk is mitigated\r\n\t\t */\r\n\t\t// check if iframe element has a sandbox attribute on it\r\n\t\tif (\r\n\t\t\t!iframe.getAttribute('sandbox') ||\r\n\t\t\t(iframe.getAttribute('sandbox') && iframe.sandbox != sandbox)\r\n\t\t) {\r\n\t\t\t// if sandbox was removed, reload this iframe\r\n\t\t\tiframe.contentWindow.location.reload();\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<div class=\"iframe-container\">\r\n\t<div class=\"header\">\r\n\t\t{#if !rendered}\r\n\t\t\tRendering...\r\n\t\t{/if}\r\n\t</div>\r\n\t<div class=\"iframe-inner\">\r\n\t\t<iframe\r\n\t\t\t{sandbox}\r\n\t\t\tallow=\"camera *;microphone *\"\r\n\t\t\ttitle=\"Rendered Component\"\r\n\t\t\tbind:this={iframe}\r\n\t\t\t{srcdoc}\r\n\t\t\tbind:offsetWidth\r\n\t\t\tallowfullscreen\r\n\t\t/>\r\n\t</div>\r\n</div>\r\n\r\n<style>\r\n\t.iframe-container {\r\n\t\tdisplay: flex;\r\n\t\tflex: 1;\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\tborder-radius: 4px;\r\n\t}\r\n\r\n\t.header {\r\n\t\tfont-weight: 700;\r\n\t\tfont-size: 0.8rem;\r\n\t\ttext-transform: uppercase;\r\n\t\tcolor: rgba(0, 0, 0, 0.7);\r\n\t}\r\n\tiframe {\r\n\t\tdisplay: flex;\r\n\t\tflex: 1;\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\tborder: 0;\r\n\t}\r\n\r\n\t.iframe-inner {\r\n\t\tdisplay: flex;\r\n\t\tflex: 1;\r\n\t\theight: 100%;\r\n\t}</style>\r\n","export const CHANGE = 'change';\r\n","<script>\r\n\timport IFrame from './IFrame.svelte';\r\n\timport { CHANGE } from './iframeSrc/constants.js';\r\n\timport { createEventDispatcher } from 'svelte';\r\n\r\n\tconst srcdoc64 = 'PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KCTxoZWFkPgoJCTxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgoJCTxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsaW5pdGlhbC1zY2FsZT0xIiAvPgoJCTxzdHlsZT4KCQkJKiB7CgkJCQltYXJnaW46IDA7CgkJCQlwYWRkaW5nOiAwOwoJCQkJLyogIGluY2x1ZGUgcGFkZGluZyBhbmQgdGhlIGJvcmRlciAqLwoJCQkJYm94LXNpemluZzogYm9yZGVyLWJveDsKCQkJCS8qIG1vcmUgcGFkZGluZyBvbiB0aGUgaW5zaWRlIG9mIHlvdXIgYm94LCBidXQgeW91IGRvbid0IHdhbnQgdGhlIGJveCB0byByZXNpemUgKi8KCQkJCS8qIGJveC1zaXppbmc6IGNvbnRlbnQtYm94OyAqLwoJCQl9CgoJCQlib2R5IHsKCQkJCW1hcmdpbjogMDsKCQkJCXBvc2l0aW9uOiByZWxhdGl2ZTsKCQkJfQoJCTwvc3R5bGU+CgkJPHNjcmlwdCBkZWZlciB0eXBlPSJtb2R1bGUiPgoJCQl2YXIgYXBwPWZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHQoKXt9ZnVuY3Rpb24gZSh0KXtyZXR1cm4gdCgpfWZ1bmN0aW9uIG4oKXtyZXR1cm4gT2JqZWN0LmNyZWF0ZShudWxsKX1mdW5jdGlvbiBvKHQpe3QuZm9yRWFjaChlKX1mdW5jdGlvbiBzKHQpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiB0fWZ1bmN0aW9uIHIodCxlKXtyZXR1cm4gdCE9dD9lPT1lOnQhPT1lfHx0JiYib2JqZWN0Ij09dHlwZW9mIHR8fCJmdW5jdGlvbiI9PXR5cGVvZiB0fWZ1bmN0aW9uIGModCxlLG4pe3QuaW5zZXJ0QmVmb3JlKGUsbnx8bnVsbCl9ZnVuY3Rpb24gaSh0KXt0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCl9ZnVuY3Rpb24gdSh0KXtyZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0KX1mdW5jdGlvbiBsKHQpe3JldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0KX1mdW5jdGlvbiBhKCl7cmV0dXJuIGwoIiIpfWNsYXNzIGR7Y29uc3RydWN0b3IodD0hMSl7dGhpcy5pc19zdmc9ITEsdGhpcy5pc19zdmc9dCx0aGlzLmU9dGhpcy5uPW51bGx9Yyh0KXt0aGlzLmgodCl9bSh0LGUsbj1udWxsKXt2YXIgbzt0aGlzLmV8fCh0aGlzLmlzX3N2Zz90aGlzLmU9KG89ZS5ub2RlTmFtZSxkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIixvKSk6dGhpcy5lPXUoZS5ub2RlTmFtZSksdGhpcy50PWUsdGhpcy5jKHQpKSx0aGlzLmkobil9aCh0KXt0aGlzLmUuaW5uZXJIVE1MPXQsdGhpcy5uPUFycmF5LmZyb20odGhpcy5lLmNoaWxkTm9kZXMpfWkodCl7Zm9yKGxldCBlPTA7ZTx0aGlzLm4ubGVuZ3RoO2UrPTEpYyh0aGlzLnQsdGhpcy5uW2VdLHQpfXAodCl7dGhpcy5kKCksdGhpcy5oKHQpLHRoaXMuaSh0aGlzLmEpfWQoKXt0aGlzLm4uZm9yRWFjaChpKX19bGV0IGY7ZnVuY3Rpb24gcCh0KXtmPXR9ZnVuY3Rpb24gaCgpe2lmKCFmKXRocm93IG5ldyBFcnJvcigiRnVuY3Rpb24gY2FsbGVkIG91dHNpZGUgY29tcG9uZW50IGluaXRpYWxpemF0aW9uIik7cmV0dXJuIGZ9ZnVuY3Rpb24gJCgpe2NvbnN0IHQ9aCgpO3JldHVybihlLG4se2NhbmNlbGFibGU6bz0hMX09e30pPT57Y29uc3Qgcz10LiQkLmNhbGxiYWNrc1tlXTtpZihzKXtjb25zdCByPWZ1bmN0aW9uKHQsZSx7YnViYmxlczpuPSExLGNhbmNlbGFibGU6bz0hMX0pe2NvbnN0IHM9ZG9jdW1lbnQuY3JlYXRlRXZlbnQoIkN1c3RvbUV2ZW50Iik7cmV0dXJuIHMuaW5pdEN1c3RvbUV2ZW50KHQsbixvLGUpLHN9KGUsbix7Y2FuY2VsYWJsZTpvfSk7cmV0dXJuIHMuc2xpY2UoKS5mb3JFYWNoKChlPT57ZS5jYWxsKHQscil9KSksIXIuZGVmYXVsdFByZXZlbnRlZH1yZXR1cm4hMH19Y29uc3QgbT1bXSxnPVtdLGI9W10seT1bXSx2PVByb21pc2UucmVzb2x2ZSgpO2xldCBfPSExO2Z1bmN0aW9uIHcodCl7Yi5wdXNoKHQpfWNvbnN0IHg9bmV3IFNldDtsZXQgRT0wO2Z1bmN0aW9uIGsoKXtjb25zdCB0PWY7ZG97Zm9yKDtFPG0ubGVuZ3RoOyl7Y29uc3QgdD1tW0VdO0UrKyxwKHQpLEwodC4kJCl9Zm9yKHAobnVsbCksbS5sZW5ndGg9MCxFPTA7Zy5sZW5ndGg7KWcucG9wKCkoKTtmb3IobGV0IHQ9MDt0PGIubGVuZ3RoO3QrPTEpe2NvbnN0IGU9Ylt0XTt4LmhhcyhlKXx8KHguYWRkKGUpLGUoKSl9Yi5sZW5ndGg9MH13aGlsZShtLmxlbmd0aCk7Zm9yKDt5Lmxlbmd0aDspeS5wb3AoKSgpO189ITEseC5jbGVhcigpLHAodCl9ZnVuY3Rpb24gTCh0KXtpZihudWxsIT09dC5mcmFnbWVudCl7dC51cGRhdGUoKSxvKHQuYmVmb3JlX3VwZGF0ZSk7Y29uc3QgZT10LmRpcnR5O3QuZGlydHk9Wy0xXSx0LmZyYWdtZW50JiZ0LmZyYWdtZW50LnAodC5jdHgsZSksdC5hZnRlcl91cGRhdGUuZm9yRWFjaCh3KX19Y29uc3QgTT1uZXcgU2V0O2xldCBqO2Z1bmN0aW9uIE8odCxlKXt0JiZ0LmkmJihNLmRlbGV0ZSh0KSx0LmkoZSkpfWZ1bmN0aW9uIE4odCxlLG4sbyl7aWYodCYmdC5vKXtpZihNLmhhcyh0KSlyZXR1cm47TS5hZGQodCksai5jLnB1c2goKCgpPT57TS5kZWxldGUodCksbyYmKG4mJnQuZCgxKSxvKCkpfSkpLHQubyhlKX1lbHNlIG8mJm8oKX1mdW5jdGlvbiBSKHQsbixyLGMpe2NvbnN0e2ZyYWdtZW50Omksb25fbW91bnQ6dSxvbl9kZXN0cm95OmwsYWZ0ZXJfdXBkYXRlOmF9PXQuJCQ7aSYmaS5tKG4sciksY3x8dygoKCk9Pntjb25zdCBuPXUubWFwKGUpLmZpbHRlcihzKTtsP2wucHVzaCguLi5uKTpvKG4pLHQuJCQub25fbW91bnQ9W119KSksYS5mb3JFYWNoKHcpfWZ1bmN0aW9uIFAodCxlKXtjb25zdCBuPXQuJCQ7bnVsbCE9PW4uZnJhZ21lbnQmJihvKG4ub25fZGVzdHJveSksbi5mcmFnbWVudCYmbi5mcmFnbWVudC5kKGUpLG4ub25fZGVzdHJveT1uLmZyYWdtZW50PW51bGwsbi5jdHg9W10pfWZ1bmN0aW9uIFUodCxlKXstMT09PXQuJCQuZGlydHlbMF0mJihtLnB1c2godCksX3x8KF89ITAsdi50aGVuKGspKSx0LiQkLmRpcnR5LmZpbGwoMCkpLHQuJCQuZGlydHlbZS8zMXwwXXw9MTw8ZSUzMX1mdW5jdGlvbiBUKGUscyxyLGMsdSxsLGEsZD1bLTFdKXtjb25zdCBoPWY7cChlKTtjb25zdCAkPWUuJCQ9e2ZyYWdtZW50Om51bGwsY3R4Om51bGwscHJvcHM6bCx1cGRhdGU6dCxub3RfZXF1YWw6dSxib3VuZDpuKCksb25fbW91bnQ6W10sb25fZGVzdHJveTpbXSxvbl9kaXNjb25uZWN0OltdLGJlZm9yZV91cGRhdGU6W10sYWZ0ZXJfdXBkYXRlOltdLGNvbnRleHQ6bmV3IE1hcChzLmNvbnRleHR8fChoP2guJCQuY29udGV4dDpbXSkpLGNhbGxiYWNrczpuKCksZGlydHk6ZCxza2lwX2JvdW5kOiExLHJvb3Q6cy50YXJnZXR8fGguJCQucm9vdH07YSYmYSgkLnJvb3QpO2xldCBtPSExO2lmKCQuY3R4PXI/cihlLHMucHJvcHN8fHt9LCgodCxuLC4uLm8pPT57Y29uc3Qgcz1vLmxlbmd0aD9vWzBdOm47cmV0dXJuICQuY3R4JiZ1KCQuY3R4W3RdLCQuY3R4W3RdPXMpJiYoISQuc2tpcF9ib3VuZCYmJC5ib3VuZFt0XSYmJC5ib3VuZFt0XShzKSxtJiZVKGUsdCkpLG59KSk6W10sJC51cGRhdGUoKSxtPSEwLG8oJC5iZWZvcmVfdXBkYXRlKSwkLmZyYWdtZW50PSEhYyYmYygkLmN0eCkscy50YXJnZXQpe2lmKHMuaHlkcmF0ZSl7Y29uc3QgdD1mdW5jdGlvbih0KXtyZXR1cm4gQXJyYXkuZnJvbSh0LmNoaWxkTm9kZXMpfShzLnRhcmdldCk7JC5mcmFnbWVudCYmJC5mcmFnbWVudC5sKHQpLHQuZm9yRWFjaChpKX1lbHNlICQuZnJhZ21lbnQmJiQuZnJhZ21lbnQuYygpO3MuaW50cm8mJk8oZS4kJC5mcmFnbWVudCksUihlLHMudGFyZ2V0LHMuYW5jaG9yLHMuY3VzdG9tRWxlbWVudCksaygpfXAoaCl9Y2xhc3MgQXskZGVzdHJveSgpe1AodGhpcywxKSx0aGlzLiRkZXN0cm95PXR9JG9uKHQsZSl7Y29uc3Qgbj10aGlzLiQkLmNhbGxiYWNrc1t0XXx8KHRoaXMuJCQuY2FsbGJhY2tzW3RdPVtdKTtyZXR1cm4gbi5wdXNoKGUpLCgpPT57Y29uc3QgdD1uLmluZGV4T2YoZSk7LTEhPT10JiZuLnNwbGljZSh0LDEpfX0kc2V0KHQpe3ZhciBlO3RoaXMuJCRzZXQmJihlPXQsMCE9PU9iamVjdC5rZXlzKGUpLmxlbmd0aCkmJih0aGlzLiQkLnNraXBfYm91bmQ9ITAsdGhpcy4kJHNldCh0KSx0aGlzLiQkLnNraXBfYm91bmQ9ITEpfX1jb25zdCBTPSJjaGFuZ2UiO2Z1bmN0aW9uIEMoZSl7bGV0IG4sbyxzLHI7cmV0dXJue2MoKXt2YXIgdCxlLGM7bj1uZXcgZCghMSksbz1hKCkscz1sKCIgIikscj11KCJkaXYiKSxuLmE9byx0PXIsZT0iY2xhc3MiLG51bGw9PShjPSJjb21wb25lbnQtbW91bnRlci10YXJnZXQiKT90LnJlbW92ZUF0dHJpYnV0ZShlKTp0LmdldEF0dHJpYnV0ZShlKSE9PWMmJnQuc2V0QXR0cmlidXRlKGUsYyksZnVuY3Rpb24odCxlLG4sbyl7bnVsbD09PW4/dC5zdHlsZS5yZW1vdmVQcm9wZXJ0eShlKTp0LnN0eWxlLnNldFByb3BlcnR5KGUsbixvPyJpbXBvcnRhbnQiOiIiKX0ociwiYWxsIiwidW5zZXQiKX0sbSh0LGkpe24ubShlWzBdLGRvY3VtZW50LmhlYWQpLGZ1bmN0aW9uKHQsZSl7dC5hcHBlbmRDaGlsZChlKX0oZG9jdW1lbnQuaGVhZCxvKSxjKHQscyxpKSxjKHQscixpKSxlWzZdKHIpfSxwKHQsW2VdKXsxJmUmJm4ucCh0WzBdKX0saTp0LG86dCxkKHQpe2kobyksdCYmbi5kKCksdCYmaShzKSx0JiZpKHIpLGVbNl0obnVsbCl9fX1mdW5jdGlvbiBIKHQsZSxuKXtsZXR7ZXNNb2R1bGU6b309ZSx7cHJvcHM6c309ZSx7Y3NzOnJ9PWU7Y29uc3QgYz0kKCk7bGV0IGksdSxsLGE7ZnVuY3Rpb24gZCh0KXtpJiZ0JiZpLiRzZXQoey4uLnR9KX12YXIgZjtyZXR1cm4gZj0oKT0+e24oNSxhPSEwKX0saCgpLiQkLm9uX21vdW50LnB1c2goZiksZnVuY3Rpb24odCl7aCgpLiQkLm9uX2Rlc3Ryb3kucHVzaCh0KX0oKCgpPT57aSYmaS4kZGVzdHJveSgpLHUmJlVSTC5yZXZva2VPYmplY3RVUkwodSl9KSksdC4kJHNldD10PT57ImVzTW9kdWxlImluIHQmJm4oMixvPXQuZXNNb2R1bGUpLCJwcm9wcyJpbiB0JiZuKDMscz10LnByb3BzKSwiY3NzImluIHQmJm4oMCxyPXQuY3NzKX0sdC4kJC51cGRhdGU9KCk9PnszNiZ0LiQkLmRpcnR5JiZhJiZvJiZhc3luYyBmdW5jdGlvbigpe24oMCxyPXI/YDxzdHlsZT4ke3J9PC9zdHlsZT5gOiIiKSxpJiYoaS4kZGVzdHJveSgpLFVSTC5yZXZva2VPYmplY3RVUkwodSkpO2NvbnN0IHQ9bmV3IEJsb2IoW29dLHt0eXBlOiJ0ZXh0L2phdmFzY3JpcHQifSk7dT1VUkwuY3JlYXRlT2JqZWN0VVJMKHQpO2NvbnN0IGU9KGF3YWl0IGltcG9ydCh1KSkuZGVmYXVsdDtpZighZXx8IWwpcmV0dXJuO24oMSxsLmlubmVySFRNTD0iIixsKSxuKDQsaT1uZXcgZSh7dGFyZ2V0OmwscHJvcHM6e319KSk7Y29uc3QgYT1pLiQkLnByb3BzO2xldCBmPXt9O09iamVjdC5rZXlzKGEpLm1hcCgodD0+e2ZbdF09aVt0XX0pKTtsZXQgcD1PYmplY3QuYXNzaWduKGYscyk7YyhTLHApLGkuJG9uKCJjaGFuZ2UiLCh0PT57YyhTLHQuZGV0YWlsKX0pKSxkKHApLHUmJlVSTC5yZXZva2VPYmplY3RVUkwodSl9KCksMjQmdC4kJC5kaXJ0eSYmaSYmcyYmZCgpfSxbcixsLG8scyxpLGEsZnVuY3Rpb24odCl7Z1t0PyJ1bnNoaWZ0IjoicHVzaCJdKCgoKT0+e2w9dCxuKDEsbCl9KSl9XX1jbGFzcyBxIGV4dGVuZHMgQXtjb25zdHJ1Y3Rvcih0KXtzdXBlcigpLFQodGhpcyx0LEgsQyxyLHtlc01vZHVsZToyLHByb3BzOjMsY3NzOjB9KX19ZnVuY3Rpb24gQih0KXtsZXQgZSxuO3JldHVybiBlPW5ldyBxKHtwcm9wczp7ZXNNb2R1bGU6dFswXSxwcm9wczp0WzFdfX0pLGUuJG9uKCJjaGFuZ2UiLHRbM10pLHtjKCl7dmFyIHQ7KHQ9ZS4kJC5mcmFnbWVudCkmJnQuYygpfSxtKHQsbyl7UihlLHQsbyksbj0hMH0scCh0LG4pe2NvbnN0IG89e307MSZuJiYoby5lc01vZHVsZT10WzBdKSwyJm4mJihvLnByb3BzPXRbMV0pLGUuJHNldChvKX0saSh0KXtufHwoTyhlLiQkLmZyYWdtZW50LHQpLG49ITApfSxvKHQpe04oZS4kJC5mcmFnbWVudCx0KSxuPSExfSxkKHQpe1AoZSx0KX19fWZ1bmN0aW9uIFgodCl7bGV0IGUsbixzLHIsdT10WzBdJiZCKHQpO3JldHVybntjKCl7dSYmdS5jKCksZT1hKCl9LG0obyxpKXt2YXIgbCxhLGQsZjt1JiZ1Lm0obyxpKSxjKG8sZSxpKSxuPSEwLHN8fChsPXdpbmRvdyxhPSJtZXNzYWdlIixkPXRbMl0sbC5hZGRFdmVudExpc3RlbmVyKGEsZCxmKSxyPSgpPT5sLnJlbW92ZUV2ZW50TGlzdGVuZXIoYSxkLGYpLHM9ITApfSxwKHQsW25dKXt0WzBdP3U/KHUucCh0LG4pLDEmbiYmTyh1LDEpKToodT1CKHQpLHUuYygpLE8odSwxKSx1Lm0oZS5wYXJlbnROb2RlLGUpKTp1JiYoaj17cjowLGM6W10scDpqfSxOKHUsMSwxLCgoKT0+e3U9bnVsbH0pKSxqLnJ8fG8oai5jKSxqPWoucCl9LGkodCl7bnx8KE8odSksbj0hMCl9LG8odCl7Tih1KSxuPSExfSxkKHQpe3UmJnUuZCh0KSx0JiZpKGUpLHM9ITEscigpfX19ZnVuY3Rpb24geih0LGUsbil7bGV0IG8scyxyO3JldHVybltvLHMsYXN5bmMgZnVuY3Rpb24odCl7dD8uZGF0YSYmKHQ/LmRhdGEuaGFzT3duUHJvcGVydHkoImxvYWQiKSYmKG4oMCwoe2VzTW9kdWxlOm8scHJvcHM6c309dC5kYXRhLmxvYWQpLG8sbigxLHMpKSxyPWU9Pnt0LnBvcnRzWzBdLnBvc3RNZXNzYWdlKGUpfSksdD8uZGF0YS5oYXNPd25Qcm9wZXJ0eSgic2V0UHJvcHMiKSYmbigxLHM9dC5kYXRhLnNldFByb3BzKSl9LGZ1bmN0aW9uKHQpe3ImJnQuZGV0YWlsJiZyKHQuZGV0YWlsKX1dfWdsb2JhbFRoaXMuZmV0Y2g9KCk9Pihjb25zb2xlLmxvZygiTnVsbGVkIG91dCBmZXRjaCIpLHtqc29uOigpPT4oe3Jlc3VsdDoibm8gZmV0Y2gsIHNvcnJ5In0pfSksZ2xvYmFsVGhpcy5YTUxIdHRwUmVxdWVzdD1jbGFzc3tjb25zdHJ1Y3Rvcigpe2NvbnNvbGUubG9nKCJOdWxsZWQgb3V0IFhIUiB0b28iKX1vcGVuPSgpPT5udWxsO3NlbmQ9KCk9Pm51bGx9LGdsb2JhbFRoaXMuV2ViU29ja2V0PW51bGwsZ2xvYmFsVGhpcy5FdmVudFNvdXJjZT1udWxsO3JldHVybiBuZXcgY2xhc3MgZXh0ZW5kcyBBe2NvbnN0cnVjdG9yKHQpe3N1cGVyKCksVCh0aGlzLHQseixYLHIse30pfX0oe3RhcmdldDpkb2N1bWVudC5ib2R5LHByb3BzOnt9fSl9KCk7CgoJCTwvc2NyaXB0PgoJPC9oZWFkPgoKCTxib2R5PjwvYm9keT4KPC9odG1sPgo=';\n\tconst srcdoc = atob(srcdoc64);\r\n\r\n\texport let esModule; // TODO: Handle error if not found\r\n\texport let css = null;\r\n\texport let props; // the consumer of this <Gateway bind:props /> component should bind the props to get updates\r\n\texport let rendered = false;\r\n\r\n\t// refresh/reload when esModule changes\r\n\t$: if (esModule && iframe) handleLoad();\r\n\r\n\tlet iframe;\r\n\tlet setProps;\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\t// this fires when props change; emits an event to update any listeners consuming this compiled component\r\n\t// $: if (props) dispatch(CHANGE, props);\r\n\r\n\t$: iframe && iframe.addEventListener('load', handleLoad);\r\n\r\n\t// Wait for the iframe to load, then configure it\r\n\tasync function handleLoad() {\r\n\t\tif (!esModule || !iframe) throw new Error('Missing esModule');\r\n\r\n\t\tconst channel = new MessageChannel();\r\n\r\n\t\tchannel.port1.onmessage = (e) => {\r\n\t\t\t// props = { ...props, ...e.data }; // update props on any reply from child\r\n\t\t\trendered = true;\r\n\t\t\tif (props || e.data) dispatch(CHANGE, Object.assign({}, props, e.data)); // this fires when props change; emits an event to update any listeners consuming this compiled component\r\n\r\n\t\t\tsetProps = (props) => {\r\n\t\t\t\tiframe.contentWindow.postMessage(\r\n\t\t\t\t\t{ setProps: props }, // push the details to the iframe\r\n\t\t\t\t\t'*' // there's only 1 contentWindow on the iframe so it' safe to use '*' as origin\r\n\t\t\t\t);\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\tiframe.contentWindow.postMessage(\r\n\t\t\t{ load: { esModule, props, css } }, // push the details to loadEsModuleComponent({ esModule, props }) in the iframe\r\n\t\t\t'*', // there's only 1 contentWindow on the iframe so it' safe to use '*' as origin\r\n\t\t\t[channel.port2]\r\n\t\t); // enables the iframe to send messages containing prop updates back to the parent\r\n\t}\r\n\r\n\t// update props as they change\r\n\t$: if (props && setProps) setProps(props);\r\n</script>\r\n\r\n<IFrame bind:iframe {srcdoc} {rendered} />\r\n","<script>\r\n\timport { onMount } from 'svelte';\r\n\r\n\texport let url;\r\n\tlet component;\r\n\r\n\tlet mounted = false;\r\n\r\n\tonMount(() => {\r\n\t\tmounted = true;\r\n\t\turl = new URL(document.location).searchParams.get('url') || url;\r\n\t\twindow.cachedURL = url;\r\n\t\tdoFetch(url);\r\n\t});\r\n\r\n\t$: if (mounted && url && window.cachedURL != url) doFetch(url);\r\n\r\n\tlet fetched;\r\n\r\n\tasync function doFetch(url) {\r\n\t\tif (!url) return;\r\n\t\ttry {\r\n\t\t\twindow.cachedURL = url; // reset cache, avoiding duplicate downloads\r\n\t\t\tfetched = await fetch(url);\r\n\t\t\tif (!fetched.ok) throw new Error(fetched.statusText);\r\n\t\t\tconst text = await fetched.text();\r\n\t\t\tcomponent = text;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.log(error);\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<div>\r\n\tLoading from: {url}\r\n</div>\r\n<slot {component} />\r\n","<script>\r\n\timport { onMount, onDestroy, createEventDispatcher } from 'svelte';\r\n\timport { CHANGE } from './iframeSrc/constants.js';\r\n\r\n\texport let esModule;\r\n\texport let props;\r\n\texport let css;\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tlet component; // the esModule component to be mounted in this gateway\r\n\tlet url;\r\n\tlet target; // where we mount this component\r\n\tlet mounted;\r\n\r\n\t$: if (mounted && esModule) loadEsModuleComponent();\r\n\r\n\t$: if (component && props) setProps();\r\n\r\n\tasync function loadEsModuleComponent() {\r\n\t\tcss = css ? `<style>${css}<\\/style>` : '';\r\n\r\n\t\t// cleanup from prior loads\r\n\t\tif (component) {\r\n\t\t\tcomponent.$destroy();\r\n\t\t\tURL.revokeObjectURL(url); // memory management\r\n\t\t}\r\n\r\n\t\tconst blob = new Blob([esModule], { type: 'text/javascript' });\r\n\t\turl = URL.createObjectURL(blob);\r\n\r\n\t\tconst App = (await import(/* @vite-ignore */ url)).default;\r\n\r\n\t\tif (!App || !target) return;\r\n\r\n\t\ttarget.innerHTML = '';\r\n\r\n\t\tcomponent = new App({ target, props: {} });\r\n\r\n\t\t// get the default values of component for each of the keys of component.$$.props\r\n\t\t// this way the parent component can deduce the schema of the data\r\n\t\tconst initProps = component['$$'].props;\r\n\t\tlet inits = {};\r\n\r\n\t\tObject.keys(initProps).map((k) => {\r\n\t\t\tinits[k] = component[k]; // load default initial props\r\n\t\t});\r\n\r\n\t\tlet allProps = Object.assign(inits, props);\r\n\r\n\t\tdispatch(CHANGE, allProps); // trigger \"rendered\" in Gateway, plus push any default values to the db to save\r\n\r\n\t\t// on change, Pass props message up to iframe parent so it can be saved/updated\r\n\t\tcomponent.$on('change', (event) => {\r\n\t\t\tdispatch(CHANGE, event.detail);\r\n\t\t});\r\n\r\n\t\tsetProps(allProps); // set them after we emit the defaults back to the user to save/display\r\n\r\n\t\tif (url) URL.revokeObjectURL(url); // memory management\r\n\t}\r\n\r\n\tfunction setProps(props) {\r\n\t\tif (!component || !props) return;\r\n\t\tcomponent.$set({ ...props });\r\n\t}\r\n\r\n\tonMount(() => {\r\n\t\tmounted = true;\r\n\t});\r\n\tonDestroy(() => {\r\n\t\tif (component) component.$destroy();\r\n\t\tif (url) URL.revokeObjectURL(url); // memory management\r\n\t});\r\n</script>\r\n\r\n<svelte:head>\r\n\t{@html css}\r\n</svelte:head>\r\n\r\n<div class=\"component-mounter-target\" bind:this={target} style=\"all:unset\">\r\n\t<!-- Component will be mounted into here  -->\r\n</div>\r\n"],"file":"_app/immutable/chunks/index-66b38260.js"}